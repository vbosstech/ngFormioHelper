!function i(s,a,l){function u(r,e){if(!a[r]){if(!s[r]){var o="function"==typeof require&&require;if(!e&&o)return o(r,!0);if(c)return c(r,!0);var t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}var n=a[r]={exports:{}};s[r][0].call(n.exports,function(e){return u(s[r][1][e]||e)},n,n.exports,i,s,a,l)}return a[r].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,r,o){"use strict";angular.module("ngFormioHelper").config(["formioComponentsProvider",function(e){e.register("resourcefields",{title:"Resource Fields",template:"formio/components/resourcefields.html",controller:["$scope","$rootScope","$http","FormioUtils","AppConfig",function(r,e,o,t,n){var i=r.component,s="";r.resourceComponents=[],e.currentForm&&e.currentForm._id&&(s="&_id__ne="+e.currentForm._id),r.resourceSelect={type:"select",input:!0,label:i.title?i.title:"Select a resource",key:"resource",placeholder:i.placeholder||"",dataSrc:"url",data:{url:i.basePath+"?type=resource"+s},valueProperty:"_id",defaultValue:r.data.resource,template:"<span>{{ item.title }}</span>",multiple:!1,protected:!1,unique:!1,persistent:!0,validate:{required:!i.hasOwnProperty("required")||i.required}},r.propertyField={label:"Resource Property",key:"property",inputType:"text",input:!0,placeholder:"Assign this resource to the following property",prefix:"",suffix:"",type:"textfield",defaultValue:r.data.property,multiple:!1};var a=[];o.get(n.apiUrl+i.basePath+"/"+i.form).then(function(e){t.eachComponent(e.data.components,function(e){"button"!==e.type&&a.push({value:e.key,label:e.label})})}),r.$watch("data.resource",function(e){e&&(r.data.fields=r.data.fields||{},e!==r.data.resource&&(r.data.resource=e),r.resourceComponents=[],o.get(n.apiUrl+i.basePath+"/"+e).then(function(e){t.eachComponent(e.data.components,function(e){"button"!==e.type&&r.resourceComponents.push({type:"select",input:!0,label:e.label,key:e.key,dataSrc:"values",defaultValue:r.data.fields[e.key],data:{values:a},validate:{required:!!e.validate&&e.validate.required}})})}))})}],settings:{input:!0,tableView:!1,builder:!1,inputType:"text",inputMask:"",label:"",key:"textField",placeholder:"",prefix:"",suffix:"",multiple:!1,defaultValue:"",protected:!1,unique:!1,persistent:!0,validate:{required:!1,minLength:"",maxLength:"",pattern:"",custom:"",customPrivate:!1}}})}])},{}],2:[function(e,r,o){"use strict";angular.module("ngFormioHelper").directive("fileread",[function(){return{scope:{fileread:"="},link:function(o,e){e.bind("change",function(e){var r=new FileReader;r.onloadend=function(e){o.$apply(function(){o.fileread=jQuery(e.target.result)})},r.readAsText(e.target.files[0])})}}}])},{}],3:[function(e,r,o){"use strict";angular.module("ngFormioHelper").directive("formioForms",function(){return{restrict:"E",replace:!0,scope:{src:"=",base:"=",tag:"=?"},templateUrl:"formio-helper/form/list.html",controller:["$scope","Formio",function(r,e){r.forms=[];var o={type:"form",limit:9999999};r.$watch("src",function(){r.src&&(r.tag&&(o.tags=r.tag),new e(r.src).loadForms({params:o}).then(function(e){r.forms=e}))})}]}})},{}],4:[function(e,r,o){"use strict";angular.module("ngFormioHelper").directive("offlineButton",function(){return{restrict:"E",replace:!0,scope:!1,controller:["$scope","$rootScope",function(e,r){e.offline=r.offline,e.hasOfflineMode=r.hasOfflineMode}],templateUrl:"formio-helper/offline/button.html"}})},{}],5:[function(e,r,o){"use strict";angular.module("ngFormioHelper").directive("offlinePopup",function(){return{restrict:"A",scope:!1,link:function(e,r){"undefined"!=typeof jQuery&&jQuery(r).popover()}}})},{}],6:[function(e,r,o){"use strict";angular.module("ngFormioHelper").factory("FormioAlerts",["$rootScope",function(r){var o=[];return r.alerts||(r.alerts=[]),{addAlert:function(e){_.find(r.alerts,{message:e.message})||(r.alerts.push(e),e.element?angular.element("#form-group-"+e.element).addClass("has-error"):o.push(e))},getAlerts:function(){var e=angular.copy(o);return o.length=0,o=[],r.alerts=[],e},onError:function e(r){if(r.message)this.addAlert({type:"danger",message:r.message,element:r.path});else{var o=r.hasOwnProperty("errors")?r.errors:r.data.errors;angular.forEach(o,e.bind(this))}}}}])},{}],7:[function(e,r,o){"use strict";angular.module("ngFormioHelper",["formio","ngFormioGrid","ngTagsInput","ui.router"]).filter("capitalize",[function(){return _.capitalize}]).filter("truncate",[function(){return function(e,r){return _.isNumber(r)&&(r={length:r}),_.truncate(e,r)}}]).run(["$templateCache","$rootScope","$state","FormioUtils",function(e,r,o,t){r.isActive=function(e){return-1!==o.current.name.indexOf(e)},e.put("formio-helper/pager.html",'<div class="paginate-anything">\n  <ul class="pagination pagination-{{size}} links" ng-if="numPages > 1">\n    <li ng-class="{disabled: page <= 0}"><a href ng-click="gotoPage(page-1)">&laquo;</a></li>\n    <li ng-if="linkGroupFirst() > 0"><a href ng-click="gotoPage(0)">1</a></li>\n    <li ng-if="linkGroupFirst() > 1" class="disabled"><a href>&hellip;</a></li>\n    <li ng-repeat="p in [linkGroupFirst(), linkGroupLast()] | makeRange" ng-class="{active: p === page}"><a href ng-click="gotoPage(p)">{{p+1}}</a></li>\n    <li ng-if="linkGroupLast() < numPages - 2" class="disabled"><a href>&hellip;</a></li>\n    <li ng-if="isFinite() && linkGroupLast() < numPages - 1"><a href ng-click="gotoPage(numPages-1)">{{numPages}}</a></li>\n    <li ng-class="{disabled: page >= numPages - 1}"><a href ng-click="gotoPage(page+1)">&raquo;</a></li>\n  </ul>\n</div>\n'),e.put("formio-helper/breadcrumb.html",'<ol class="breadcrumb">\n  <li ng-repeat="step in steps" ng-class="{active: $last}">\n    <a ui-sref="{{ step.name }}.view" ng-bind-html="step.ncyBreadcrumbLabel"></a>\n  </li>\n</ol>\n'),e.put("formio-helper/auth/auth.html",'<div class="col-md-8 col-md-offset-2">\n    <div class="panel panel-default">\n        <div class="panel-heading" style="padding-bottom: 0; border-bottom: none;">\n            <ul class="nav nav-tabs" style="border-bottom: none;">\n                <li role="presentation" ng-class="{active:isActive(\'auth.login\')}"><a ui-sref="auth.login()">Login</a></li>\n                <li role="presentation" ng-class="{active:isActive(\'auth.register\')}"><a ui-sref="auth.register()">Register</a></li>\n            </ul>\n        </div>\n        <div class="panel-body">\n            <div class="row">\n                <div class="col-lg-12">\n                    <div ui-view></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),e.put("formio-helper/auth/login.html",'<formio src="currentForm" formio-options="{skipQueue: true}"></formio>'),e.put("formio-helper/auth/register.html",'<formio src="currentForm" formio-options="{skipQueue: true}"></formio>\n'),e.put("formio-helper/resource/resource.html",'<h2>{{ currentResource.name | capitalize }}</h2>\n<ul class="nav nav-tabs" ng-if="isReady">\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.view\')}" ng-if="hasAccess(currentResource.name, [\'read_all\', \'read_own\'])"><a ui-sref="{{ baseName }}.view()">View</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.edit\')}" ng-if="hasAccess(currentResource.name, [\'update_all\', \'update_own\'])"><a ui-sref="{{ baseName }}.edit()">Edit</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.delete\')}" ng-if="hasAccess(currentResource.name, [\'delete_all\', \'delete_own\'])"><a ui-sref="{{ baseName }}.delete()">Delete</a></li>\n</ul>\n<div ui-view></div>\n'),e.put("formio-helper/resource/create.html",'<h3 ng-if="pageTitle">{{ pageTitle }}</h3>\n<hr ng-if="pageTitle"></hr>\n<formio src="currentResource.formUrl" submission="submission" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/resource/delete.html",'<formio-delete src="currentResource.submissionUrl" resource-name="resourceName"></formio-delete>\n'),e.put("formio-helper/resource/edit.html",'<formio src="currentResource.submissionUrl" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/resource/index.html",'<formio-grid src="currentResource.formUrl" columns="currentResource.columns" query="currentResource.gridQuery" grid-options="currentResource.gridOptions"></formio-grid><br/>\n<a ui-sref="{{ baseName }}Create()" class="btn btn-primary" ng-if="isReady && hasAccess(currentResource.name, [\'create_own\', \'create_all\'])"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New {{ currentResource.name | capitalize }}</a>\n'),e.put("formio-helper/resource/view.html",'<formio src="currentResource.submissionUrl" read-only="true"></formio>\n'),e.put("formio-helper/form/list.html",'<ul class="list-group">\n    <li class="list-group-item" ng-repeat="form in forms | orderBy: \'title\'"><a ui-sref="{{ base }}form.view({formId: form._id})">{{ form.title }}</a></li>\n</ul>\n'),e.put("formio-helper/form/index.html",'<formio-forms src="formsSrc" tag="formsTag" base="formBase"></formio-forms>\n'),e.put("formio-helper/form/form.html",'<ul class="nav nav-tabs">\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.view\')}"><a ui-sref="{{ formBase }}form.view()">Form</a></li>\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submissions\')}"><a ui-sref="{{ formBase }}form.submissions()">Submissions</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>\n'),e.put("formio-helper/form/view.html",'<formio form="currentForm.form" form-action="currentForm.url + \'/submission\'" submission="submission" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/submission/index.html",'<formio-grid src="currentForm.url" query="submissionQuery" columns="submissionColumns"></formio-grid>\n\n'),e.put("formio-helper/submission/submission.html",'<ul class="nav nav-pills">\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.view\')}"><a ui-sref="{{ formBase }}form.submission.view()">View</a></li>\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.edit\')}"><a ui-sref="{{ formBase }}form.submission.edit()">Edit</a></li>\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.delete\')}"><a ui-sref="{{ formBase }}form.submission.delete()">Delete</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>\n'),e.put("formio-helper/submission/view.html",'<formio form="currentForm.form" submission="currentSubmission.submission" read-only="true"></formio>\n'),e.put("formio-helper/submission/edit.html",'<formio form="currentForm.form" submission="currentSubmission.submission" form-action="currentSubmission.url"></formio>\n'),e.put("formio-helper/submission/delete.html",'<formio-delete src="currentSubmission.url"></formio-delete>\n'),e.put("formio-helper/offline/index.html",'<div>\n    <h2>The following submission had an error. Please correct it and resubmit.</h2>\n    <formio src="currentSubmission.url" submission="currentSubmission.data" hide-components="[\'submit\']"></formio>\n    <a class="btn btn-lg btn-info" ng-click="submitSubmission()">Retry</a>\n    <a class="btn btn-lg btn-warning" ng-click="cancelSubmission()">Cancel Submission</a>\n</div>'),e.put("formio-helper/offline/button.html",'<div class="offline-button">\n    <div ng-if="hasOfflineMode">\n        <span class="navbar-text" ng-click="offline.forceOffline(!offline.isForcedOffline())" style="cursor:pointer;">\n            <i class="glyphicon glyphicon-signal text-success" ng-class="{ \'text-danger\': (offline.isForcedOffline() || !offline.enabled), \'text-warning\' : offline.offline }"></i>\n        </span>\n        <span ng-if="offline.submissionQueueLength()" ng-click="offline.dequeueSubmissions()" class="navbar-text" style="cursor:pointer;">\n            <span class="badge">{{ offline.submissionQueueLength() }} Queued</span> <i class="glyphicon glyphicon-refresh" ng-class="{ \'glyphicon-spin\': offline.dequeuing }"></i>\n        </span>\n    </div>\n    <div ng-if="!hasOfflineMode">\n        <span class="navbar-text">\n            <a tabindex="0" offline-popup role="button" data-toggle="popover" data-placement="bottom" data-trigger="focus" title="Offline Mode Disabled" data-content="You must upgrade your project to Team Pro to enable offline mode support. Please contact support@form.io for more information."><i class="glyphicon glyphicon-signal text-danger"></i></a>\n        </span>\n    </div>\n</div>'),e.put("formio/components/resourcefields.html",t.fieldWrap('<formio-component component="resourceSelect" data="data"></formio-component>\n<formio-component ng-if="data.resource" component="propertyField" data="data"></formio-component>\n<fieldset ng-if="data.resource">\n  <legend>Resource Fields</legend>\n  <div class="well">Below are the fields within the selected resource. For each of these fields, select the corresponding field within this form that you wish to map to the selected Resource.</div>\n  <formio-component ng-repeat="resourceComponent in resourceComponents" component="resourceComponent" data="data.fields"></formio-component>\n</fieldset>\n'))}]),e("./components/resourcefields.js"),e("./directives/fileread.js"),e("./directives/formioForms.js"),e("./directives/offlineButton.js"),e("./directives/offlinePopup.js"),e("./factories/FormioAlerts.js"),e("./providers/FormioAuth.js"),e("./providers/FormioForms.js"),e("./providers/FormioOffline.js"),e("./providers/FormioResource.js")},{"./components/resourcefields.js":1,"./directives/fileread.js":2,"./directives/formioForms.js":3,"./directives/offlineButton.js":4,"./directives/offlinePopup.js":5,"./factories/FormioAlerts.js":6,"./providers/FormioAuth.js":8,"./providers/FormioForms.js":9,"./providers/FormioOffline.js":10,"./providers/FormioResource.js":11}],8:[function(e,r,o){"use strict";angular.module("ngFormioHelper").provider("FormioAuth",["$stateProvider","FormioProvider",function(a,r){var c=!1,m="auth.login",f=!1,i="home",p=[],l=!1,d={},h={},g={},b={setForceAuth:function(e){p="boolean"==typeof e?e?["auth"]:[]:e},auth:function(e,r,o,t){return t.all([o.projectRequest(),o.accessRequest()]).then(function(){return o.setUser(e,r)})},login:function(e,r,o,t,n){return b.auth(e,r,o,n).then(function(e){var r=window.sessionStorage.getItem("authRedirect");return r?(r=JSON.parse(r),window.sessionStorage.removeItem("authRedirect"),t.go(r.toState.name,r.toParams)):t.go(i),e})},setStates:function(e,r){m=e,i=r},setAnonRole:function(e){f=e},setAppUrl:function(e){r.setProjectUrl(e)},setProjectUrl:function(e){r.setProjectUrl(e)},register:function(e,i,r,s,o){var t=s&&!o;l||(l=!0,a.state("auth",{abstract:!0,url:"/auth",templateUrl:t?"formio-helper/auth/auth.html":"views/user/auth.html"})),r||(r=e);var n=e.toLowerCase()+".html";a.state("auth."+e,{url:"/"+r,templateUrl:t?"formio-helper/auth/"+n:"views/user/"+n,controller:["$scope","$state","$rootScope","$q",function(e,o,t,n){e.currentForm=s,e.$on("formSubmission",function(e,r){r&&b.login(r,i,t,o,n)})}]})},$get:["Formio","FormioAlerts","$rootScope","$state","$stateParams","$http","$q",function(i,n,s,a,l,e,u){return{init:function(e){c=!0,s.user=null,s.isReady=!1,s.projectRequest=function(){return i.makeStaticRequest(i.getProjectUrl()).then(function(e){angular.forEach(e.access,function(e){d[e.type]=e.roles})},function(e){return d={},null})},s.accessRequest=function(){return i.makeStaticRequest(i.getProjectUrl()+"/access").then(function(e){return angular.forEach(e.forms,function(r){h[r.name]={},r.submissionAccess.forEach(function(e){h[r.name][e.type]=e.roles})}),g=e.roles,e},function(e){return g={},null})};var r=null;e&&e.oauth?(window.location.hash&&window.location.hash.match(/^#\/access_token/)&&history.pushState(null,null,window.location.hash.replace(/^#\/access_token/,"#access_token")),r=i.ssoInit(e.oauth.type,e.oauth.options)):r=i.currentUser();var o=localStorage.getItem("formioAppRole")||"user";s.userPromise=r.then(function(e){return e?b.auth(e,o,s,u):s.setUser(null,o)}),s.hasRole=function(e){return e=e.toLowerCase(),s.user?!!g[e]&&-1!==s.user.roles.indexOf(g[e]._id):"anonymous"===e},s.ifRole=function(e){return s.whenReady.then(function(){return s.isAdmin||s.hasRole(e)})},s.assignRoles=function(){if(!g)return s.isAdmin=!1;for(var e in g)if(g[e].admin&&(s["is"+g[e].title.replace(/\s/g,"")]=s.isAdmin=s.hasRole(e),s.isAdmin))break;for(var e in g)g[e].admin||(s["is"+g[e].title.replace(/\s/g,"")]=s.hasRole(e))},s.whenReady=s.userPromise.then(function(){return s.isReady=!0}),s.isRole=function(e){return s.role===e.toLowerCase()},s.setUser=function(e,r){return e?(s.user=e,localStorage.setItem("formioAppUser",angular.toJson(e))):(s.user=null,localStorage.removeItem("formioAppUser"),i.clearCache(),i.setUser(null)),r?(s.role=r.toLowerCase(),localStorage.setItem("formioAppRole",r)):(s.role=null,localStorage.removeItem("formioAppRole")),s.authenticated=!!i.getToken(),s.assignRoles(),s.$emit("user",{user:s.user,role:s.role}),s.user},s.checkAccess=function(o,e){if(!c)return!0;if(Array.isArray(e)||(e=[e]),!o)return!1;var t=!1;return e.forEach(function(r){if(!o[r])return!1;s.user?s.user.roles.forEach(function(e){-1!==o[r].indexOf(e)&&(t=!0)}):-1!==o[r].indexOf(f)&&(t=!0)}),t},s.formAccess=function(e){return s.checkAccess(d,e)},s.hasAccess=function(e,r){return s.checkAccess(h[e],r)},s.ifAccess=function(e,r){return s.whenReady.then(function(){return s.hasAccess(e,r)})};var t=function(){a.current.name&&!window.sessionStorage.getItem("authRedirect")&&window.sessionStorage.setItem("authRedirect",JSON.stringify({toState:a.current,toParams:l})),s.setUser(null,null),localStorage.removeItem("formioToken"),a.go(m,l,{reload:!0,inherit:!1,notify:!0}),n.addAlert({type:"danger",message:"Your session has expired. Please log in again."})};s.$on("formio.sessionExpired",t),i.events.on("formio.badToken",t),i.events.on("formio.sessionExpired",t),s.logout=function(){s.setUser(null,null),localStorage.removeItem("formioToken"),i.logout().then(function(){a.go(m,l,{reload:!0,inherit:!1,notify:!0})}).catch(t)},s.$on("$stateChangeStart",function(e,r,o){if(s.authenticated=!!i.getToken(),!s.authenticated&&p.length){var t=!1;for(var n in p)if(0===r.name.indexOf(p[n])){t=!0;break}if(t)return;window.sessionStorage.setItem("authRedirect",JSON.stringify({toState:r,toParams:o})),e.preventDefault(),a.go(m,{},{reload:!0})}}),s.$on("$stateChangeSuccess",function(){s.alerts=n.getAlerts()})}}}]};return b}])},{}],9:[function(e,r,o){"use strict";angular.module("ngFormioHelper").provider("FormioForms",["$stateProvider",function(r){var e={};return{register:function(i,s,t){var e=(t=t||{}).templates?t.templates:{},a=t.controllers?t.controllers:{},l="string"==typeof t.field?[t.field]:t.field;l=_.map(l,function(e){return"string"==typeof e?{name:e,stateParam:e+"Id"}:e});var u=t.base?t.base:"";u||(u=i?i+".":""),r.state(u+"formIndex",{url:"/forms",params:t.params&&t.params.index,ncyBreadcrumb:{skip:!0},templateUrl:e.index?e.index:"formio-helper/form/index.html",controller:["$scope","Formio","$controller",function(e,r,o){e.formBase=u,e.formsSrc=s+"/form",e.formsTag=e.formsTag||t.tag,a.index&&o(a.index,{$scope:e})}]}).state(u+"form",{url:"/form/:formId",abstract:!0,ncyBreadcrumb:_.get(t,"breadcrumb.form",{skip:!0}),templateUrl:e.form?e.form:"formio-helper/form/form.html",controller:["$scope","$stateParams","Formio","$controller",function(r,e,o,t){var n=s+"/form/"+e.formId;r.formBase=u,r.currentForm={name:i,url:n,form:{}},r.currentForm.formio=new o(n),r.currentForm.promise=r.currentForm.formio.loadForm().then(function(e){return r.currentForm.form=e}),a.form&&t(a.form,{$scope:r})}]}).state(u+"form.view",{url:"/",params:t.params&&t.params.view,ncyBreadcrumb:{skip:!0},templateUrl:e.view?e.view:"formio-helper/form/view.html",controller:["$scope","$state","FormioUtils","$controller",function(t,e,r,o){var n=!(t.submission={data:{}});(l&&l.length&&(t.hideComponents=_.map(l,function(e){return e.name}),t.currentForm.promise.then(function(){l.forEach(function(r){var e=r.name.split("."),o=e[e.length-1];t[o].loadSubmissionPromise.then(function(e){_.set(t.submission.data,r.name,e)})})})),a.view)&&(n=o(a.view,{$scope:t}).handle||!1);n||t.$on("formSubmission",function(){e.go(u+"form.submissions")})}]}).state(u+"form.submissions",{url:"/submissions",ncyBreadcrumb:{skip:!0},params:t.params&&t.params.submissions,templateUrl:e.submissions?e.submissions:"formio-helper/submission/index.html",controller:["$scope","$state","$stateParams","FormioUtils","$controller","$timeout",function(r,o,t,n,e,i){r.submissionQuery={},r.submissionColumns=[],l&&l.length&&l.forEach(function(e){r.submissionQuery["data."+e.name+"._id"]=t[e.stateParam]});var s=function(e,r){i(function(){o.go(u+"form.submission.view",{formId:r.form,submissionId:r._id})})};r.$on("rowView",s),r.$on("rowSelect",s),a.submissions&&e(a.submissions,{$scope:r}),r.currentForm.promise.then(function(e){localStorage.setItem(e.name,""),r.submissionColumns.length||0!==!Object.keys(r.submissionColumns).length||(n.eachComponent(e.components,function(e){e.key&&e.input&&e.tableView&&(l&&l.length&&!_.find(l,{name:e.key})||r.submissionColumns.push(e.key))}),r.$broadcast("reloadGrid"))})}]}).state(u+"form.submission",{abstract:!0,url:"/submission/:submissionId",ncyBreadcrumb:_.get(t,"breadcrumb.submission",{skip:!0}),params:t.params&&t.params.submission,templateUrl:e.submission?e.submission:"formio-helper/submission/submission.html",controller:["$scope","$stateParams","Formio","$controller",function(r,e,o,t){r.currentSubmission={url:r.currentForm.url+"/submission/"+e.submissionId,submission:{data:{}}},r.currentSubmission.formio=new o(r.currentSubmission.url),r.currentSubmission.promise=r.currentSubmission.formio.loadSubmission().then(function(e){return r.currentSubmission.submission=e}),a.submission&&t(a.submission,{$scope:r})}]}).state(u+"form.submission.view",{url:"/",params:t.params&&t.params.submissionView,ncyBreadcrumb:{skip:!0},templateUrl:e.submissionView?e.submissionView:"formio-helper/submission/view.html",controller:["$scope","$controller",function(e,r){a.submissionView&&r(a.submissionView,{$scope:e})}]}).state(u+"form.submission.edit",{url:"/edit",params:t.params&&t.params.submissionEdit,ncyBreadcrumb:{skip:!0},templateUrl:e.submissionEdit?e.submissionEdit:"formio-helper/submission/edit.html",controller:["$scope","$state","$controller",function(o,t,e){var r=!1;a.submissionEdit&&(r=e(a.submissionEdit,{$scope:o}).handle||!1);r||o.$on("formSubmission",function(e,r){o.currentSubmission.submission=r,t.go(u+"form.submission.view")})}]}).state(u+"form.submission.delete",{url:"/delete",params:t.params&&t.params.submissionDelete,ncyBreadcrumb:{skip:!0},templateUrl:e.submissionDelete?e.submissionDelete:"formio-helper/submission/delete.html",controller:["$scope","$state","$controller",function(e,r,o){var t=!1;a.submissionDelete&&(t=o(a.submissionDelete,{$scope:e}).handle||!1);t||(e.$on("delete",function(){r.go(u+"form.submissions")}),e.$on("cancel",function(){r.go(u+"form.submission.view")}))}]})},$get:function(){return e}}}])},{}],10:[function(e,r,o){"use strict";angular.module("ngFormioHelper").provider("FormioOffline",["$stateProvider",function(e){return{register:function(n){n=n||{},e.state("offline",{url:n.errorUrl||"/offline/error",templateUrl:"formio-helper/offline/index.html",params:{currentSubmission:{}},controller:["$scope","$stateParams","$rootScope","$state",function(e,r,o,t){"undefined"!=typeof FormioOfflineProject&&(e.currentSubmission=r.currentSubmission,e.submitSubmission=function(){o.offline.dequeueSubmissions(),t.go(n.homeState||"home")},e.cancelSubmission=function(){o.offline.skipNextQueuedSubmission(),o.offline.dequeueSubmissions(),t.go(n.homeState||"home")})}]})},$get:["Formio","FormioAlerts","$rootScope","AppConfig","$window","$state",function(o,t,n,i,s,a){return{init:function(){if("undefined"==typeof FormioOfflineProject)return console.log("setting off"),void(n.hasOfflineMode=!1);console.log("setting on"),n.hasOfflineMode=!0,n.appVersion=i.appVersion,n.offline=new FormioOfflineProject(i.appUrl,"project.json"),o.registerPlugin(n.offline,"offline"),n.offline.onError=function(e){t.addAlert({type:"danger",message:"Failed to save offline cache. This could result in missing data."})},o.events.on("offline.formError",function(e,r){t.addAlert({message:e,type:"danger"}),a.go("offline",{currentSubmission:r.request})});var e=s.applicationCache,r=_.debounce(function(){e.update()},6e4);e&&(e.addEventListener("updateready",function(){e.status==e.UPDATEREADY&&confirm("A new version of the application is available. Would you like to load it?")&&(e.swapCache(),s.location.reload())},!1),n.$on("$stateChangeStart",function(){e.status!==e.UNCACHED&&e.status!==e.OBSOLETE&&r()}))}}}]}}])},{}],11:[function(e,r,o){"use strict";angular.module("ngFormioHelper").provider("FormioResource",["$stateProvider","$injector",function(s,d){var h={};return{register:function(a,l,u){u=u||{},h[a]=u.title||a;var e=u&&u.parent?u.parent:null,c=u&&u.parents?u.parents:[];c&&c.length||!e||(c=[e]);var m=a+"Id";u.base=u.base||"";var f=u.base+a,i=function(e){var r={};return r[m]=e._id,r},r=null;try{r=d.get("$breadcrumbProvider")}catch(e){r=null}u.breadcrumb&&r&&r.setOptions({includeAbstract:!0,templateUrl:"formio-helper/breadcrumb.html"});var o=function(e){return e};u.alter=angular.extend({index:o,create:o,abstract:o,view:o,edit:o,delete:o},u.alter);var t=u&&u.templates?u.templates:{},p=u&&u.controllers?u.controllers:{},n=u.query?u.query:"";s.state(f+"Index",u.alter.index({url:"/"+a+n,params:u.params&&u.params.index,data:u.data&&u.data.index,templateUrl:t.index?t.index:"formio-helper/resource/index.html",ncyBreadcrumb:{skip:!0},controller:["$scope","$state","$stateParams","$controller",function(e,o,r,t){e.baseName=f;var n={};c.length&&c.forEach(function(e){r.hasOwnProperty(e+"Id")&&(n["data."+e+"._id"]=r[e+"Id"])}),e.currentResource={name:a,queryId:m,formUrl:l,columns:[],gridQuery:n,gridOptions:{}},e.$on("rowView",function(e,r){o.go(f+".view",i(r))}),e.$on("submissionView",function(e,r){o.go(f+".view",i(r))}),e.$on("submissionEdit",function(e,r){o.go(f+".edit",i(r))}),e.$on("submissionDelete",function(e,r){o.go(f+".delete",i(r))}),p.index&&t(p.index,{$scope:e})}]})).state(f+"Create",u.alter.create({url:"/create/"+a+n,params:u.params&&u.params.create,data:u.data&&u.data.create,templateUrl:t.create?t.create:"formio-helper/resource/create.html",ncyBreadcrumb:{skip:!0},controller:["$scope","$state","$controller",function(o,t,e){o.baseName=f,o.currentResource={name:a,queryId:m,formUrl:l},o.submission=u.defaultValue?u.defaultValue:{data:{}},o.pageTitle="New "+_.capitalize(a);var r=!1;p.create&&(r=e(p.create,{$scope:o}).handle||!1);c.length&&(o.hideComponents||(o.hideComponents=[]),o.hideComponents=o.hideComponents.concat(c),c.forEach(function(r){o[r].loadSubmissionPromise.then(function(e){o.submission.data[r]=e})})),r||o.$on("formSubmission",function(e,r){o.currentResource.resource=r,t.go(f+".view",i(r))})}]})).state(f,u.alter.abstract({abstract:!0,url:"/"+a+"/:"+m,data:u.data&&u.data.abstract,templateUrl:t.abstract?t.abstract:"formio-helper/resource/resource.html",ncyBreadcrumb:u.breadcrumb?{label:u.breadcrumb.label}:{skip:!0},controller:["$scope","$stateParams","Formio","$controller","$http",function(r,e,o,t,n){var i=l,s=u.endpoint;s?s+="/"+e[m]:i+="/submission/"+e[m],r.baseName=f,r.currentResource=r[a]={name:a,queryId:m,formUrl:l,submissionUrl:i,formio:new o(i),resource:{},form:{},href:"/#/"+a+"/"+e[m]+"/",parent:1===c.length?r[c[0]]:{href:"/#/",name:"home"}},r.currentResource.loadFormPromise=r.currentResource.formio.loadForm().then(function(e){return r.currentResource.form=r[a].form=e,e}),u.endpoint?r.currentResource.loadSubmissionPromise=n.get(s,{headers:{"x-jwt-token":o.getToken()}}).then(function(e){return r.currentResource.resource=e.data,e.data}):r.currentResource.loadSubmissionPromise=r.currentResource.formio.loadSubmission().then(function(e){return r.currentResource.resource=r[a].submission=e,e}),p.abstract&&t(p.abstract,{$scope:r})}]})).state(f+".view",u.alter.view({url:"/",params:u.params&&u.params.view,data:u.data&&u.data.view,templateUrl:t.view?t.view:"formio-helper/resource/view.html",ncyBreadcrumb:{skip:!0},controller:["$scope","$controller",function(e,r){p.view&&r(p.view,{$scope:e})}]})).state(f+".edit",u.alter.edit({url:"/edit",params:u.params&&u.params.edit,data:u.data&&u.data.edit,templateUrl:t.edit?t.edit:"formio-helper/resource/edit.html",ncyBreadcrumb:{skip:!0},controller:["$scope","$state","$controller",function(o,t,e){var r=!1;(c.length&&(o.hideComponents||(o.hideComponents=[]),o.hideComponents=o.hideComponents.concat(c)),p.edit)&&(r=e(p.edit,{$scope:o}).handle||!1);r||o.$on("formSubmission",function(e,r){o.currentResource.resource=r,t.go(f+".view",i(r))})}]})).state(f+".delete",u.alter.delete({url:"/delete",params:u.params&&u.params.delete,data:u.data&&u.data.delete,templateUrl:t.delete?t.delete:"formio-helper/resource/delete.html",ncyBreadcrumb:{skip:!0},controller:["$scope","$state","$controller",function(e,r,o){var t=!1;(e.resourceName=a,p.delete)&&(t=o(p.delete,{$scope:e}).handle||!1);t||(e.$on("delete",function(){1===c.length&&"home"!==c[0]?r.go(c[0]+".view"):r.go("home",null,{reload:!0})}),e.$on("cancel",function(){r.go(f+"Index")}))}]}))},$get:function(){return h}}}])},{}]},{},[7]);